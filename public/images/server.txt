#include<iostream>
#include<sys/socket.h>
#include<sys/types.h>
#include<netinet/in.h>
#include<arpa/inet.h>
#include<unistd.h>
#include<string.h>
#define PORT 6666
using namespace std;

int main()
{
	char ip_serv[]="192.168.3.1";
	char message[100];
	sockaddr_in s_address,client_address;
	int s_id,new_s_id;
	s_id=socket(AF_INET,SOCK_STREAM,0);
	if(s_id==-1)
	{
		cout<<"Socket could not be craeted "<<endl;
		exit(0);
		}
		s_address.sin_family=AF_INET;
		s_address.sin_port=htons(PORT);
		//int p=inet_aton(ip_serv,&s_address.sin_addr);
		//cout<<"Aton : "<<p<<endl;
		s_address.sin_addr.s_addr=INADDR_ANY;
		for(int i=0;i<8;i++)
		s_address.sin_zero[i]=0;
		cout<<"IP address given is : "<<inet_ntoa(s_address.sin_addr)<<endl;
		if(bind(s_id,(struct sockaddr *)&s_address,sizeof(s_address))==-1)
		{
			cout<<"Bind Unsuccefull "<<endl;
			exit(0);
			}
		
		if(listen(s_id,5)==-1)
		{
			cout<<"Listen Operation Unsuccessfull "<<endl;
			exit(0);
		}
		int addrlen=sizeof(struct sockaddr_in);
		new_s_id=accept(s_id,(struct sockaddr *)&s_address,(socklen_t *)&addrlen);
		if(new_s_id==-1)
		{
			cout<<"Accept Unsuccessfull "<<endl;
			exit(0);
		}
		string strMessage="";
		do
		{
		int n=read(new_s_id,message,200);
		if(n!=-1)
		cout<<"Client : "<<message<<endl;		
		for(int i=0;message[i]!='\0';i++)
		strMessage+=message[i];
		}while(strMessage!="stop");	
		
}
